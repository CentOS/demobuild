# Setting up a laptop to provide a gateway

    [root@mazer ~]# ip addr add 172.28.0.2/16 dev enp0s25
    [root@mazer ~]# sysctl -w net.ipv4.ip_forward=1
    net.ipv4.ip_forward = 1
    [root@mazer ~]# firewall-cmd --direct --passthrough ipv4 -t nat -I POSTROUTING -o wlp3s0 -j MASQUERADE -s 172.28.0.0/16
    success
    [root@mazer ~]# firewall-cmd --direct --passthrough ipv4 -I FORWARD -i enp0s25 -j ACCEPT
    success

    # Optional in order to visit the foreman interface from the laptop
    [root@mazer ~]# echo 'foreman.democluster.osas 172.28.0.1' >> /etc/hosts

# Installing the foreman image

    linuxefi ... biosdevname=0 net.ifnames=0 ip=172.28.0.1 netmask=255.255.0.0 dns=8.8.8.8 gateway=172.28.0.2 inst.ks=http://www.bstinson.com/foreman.ks

# Run the foreman installer (the cli invocation is generated by the kickstart)

    [root@foreman ~]# sh /root/install-foreman.sh

# Make sure we've gathered the first round of facts

    [root@foreman ~]# puppet agent -t

# Point Firefox at the foreman interface
    
    https://foreman.democluster.lan
    Username: admin
    Password: centos

# Change the Installation Media to point at the correct location
    Hosts -> Installation Media -> CentOS Mirror

    Change the Path to: http://mirror.centos.org/centos/$major/os/$arch

# Activate the Provisioning Templates
    Hosts -> Provisioning templates

    1. Choose 'Kickstart default' -> Association -> Select 'CentOS 7.2'
    1. Choose 'Kickstart default finish' -> Association -> Select 'CentOS 7.2'
    1. Choose 'Kickstart default iPXE' -> Association -> Select 'CentOS 7.2'
    1. Choose 'Kickstart default PXELinux' -> Association -> Select 'CentOS 7.2'

# Update the PXE Templates to include the Discovery image
    1. Update the PXELinux Global Default template to boot the discovery image 
        Change:
         ONTIMEOUT local
        TO
         ONTIMEOUT discovery

    1. Point the discovery template to the foreman instance in the PXELinux
       Global Default Template

        APPEND initrd=boot/fdi-image/initrd0.img ... **proxy.url=https://foreman.democluster.osas proxy.type=foreman**

    1. Click the 'Build PXE Default' Button

# Choose the templates in the OS Config
    Hosts -> Operating Systems -> 'CentOS 7.2'

    1. Under 'Templates' choose the appropriate kickstart template for each
       dropdown
    1. Under 'Installation media' choose 'CentOS Mirror'
    1. Under 'Partition Table' check 'Kickstart default'

# Add a subnet
    Infrastructure -> Subnets -> New Subnet

### Subnet
    Name: democluster
    Network Address: 172.28.0.0
    Netowrk Mask: 255.255.0.0
    Gateway Address: 172.28.0.2
    Primary DNS Server: 172.28.0.1
    Start of IP Range: 172.28.1.1
    Start of IP Range: 172.28.1.254

### Domains
    Domain: democluster.lan

# Set up the default hostgroup
    Configure -> Host Groups -> New Hostgroup

### Host Group 
    Name: Minnowboards
    Environment: Production
    Puppet CA: forman.democluster.lan
    Puppet Master: forman.democluster.lan

### Operating System
    arch: x86_64
    Operating System: CentOS 7.2
    Media: CentOS mirror
    Partition Table: Kickstart Default
    Root password: centosl33n0x

# Configure The Domain
    Infrastructure -> Domains -> democluster.osas

    1. DNS Proxy: foreman.democluster.osas
